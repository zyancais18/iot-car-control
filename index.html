<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Control IoT</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <header class="app-header px-3 py-2">
    <div class="container-fluid d-flex align-items-center justify-content-between">
      <h1 class="h4 m-0 text-white">Control IoT</h1>
      <div class="d-flex gap-4 align-items-center text-white">
        <div class="form-check form-switch m-0">
          <input class="form-check-input" type="radio" name="mode" id="modeManual" checked>
          <label class="form-check-label" for="modeManual">Manual</label>
        </div>
        <div class="form-check form-switch m-0">
          <input class="form-check-input" type="radio" name="mode" id="modeAuto">
          <label class="form-check-label" for="modeAuto">Autom√°tico</label>
        </div>
      </div>
    </div>
  </header>

  <main class="container py-4">
    <!-- Barra de controles (solo Autom√°tico) -->
    <div id="autoBar" class="row g-2 align-items-center mb-3 d-none">
      <div class="col-auto"><span class="label">Velocidad</span></div>
      <div class="col-auto">
        <select id="speedMode" class="form-select form-select-sm">
          <option value="snail">üêå Caracol (muy lento)</option>
          <option value="fox">ü¶ä Zorro (normal)</option>
          <option value="cheetah">üêÜ Guepardo (r√°pido)</option>
        </select>
      </div>
      <div class="col-auto">
        <input id="msInput" type="number" class="form-control form-control-sm slim" value="200" min="50" step="10" readonly>
      </div>
      <div class="col-auto"><button id="btnGrabar" class="btn btn-outline-primary btn-sm">Grabar</button></div>
      <div class="col-auto"><button id="btnGuardar" class="btn btn-outline-primary btn-sm" disabled>Guardar</button></div>
      <div class="col-auto"><button id="btnCargar" class="btn btn-outline-primary btn-sm">Cargar</button></div>
      <div class="col-auto"><button id="btnDetener" class="btn btn-outline-danger btn-sm" disabled>Detener</button></div>
    </div>

    <!-- La flor de botones -->
    <section class="d-flex justify-content-center position-relative">
      <div id="flower" class="flower position-relative">
        <!-- Indicador de grabaci√≥n -->
        <div id="recStatus"
             class="small text-secondary"
             style="position:absolute; right:-150px; top:0; width:140px;"
             hidden>
          Grabando: 0 pasos‚Ä¶
        </div>

        <!-- centro -->
        <button class="petal center" data-status="3" aria-label="Detener"></button>

        <!-- p√©talos (arriba/der/izq) -->
        <button class="petal p-top"      data-status="1" aria-label="Adelante"></button>
        <button class="petal p-top-right" data-status="4" aria-label="Vuelta adelante derecha"></button>
        <button class="petal p-right"     data-status="8" aria-label="Giro 90 derecha"></button>
        <button class="petal p-bottom-right" data-status="6" aria-label="Vuelta atr√°s derecha"></button>

        <button class="petal p-bottom" data-status="2" aria-label="Atr√°s"></button>
        <button class="petal p-bottom-left" data-status="7" aria-label="Vuelta atr√°s izquierda"></button>
        <button class="petal p-left"   data-status="9" aria-label="Giro 90 izquierda"></button>
        <button class="petal p-top-left" data-status="5" aria-label="Vuelta adelante izquierda"></button>

        <!-- hojas 360¬∞ -->
        <button class="leaf leaf-left"  data-status="11" aria-label="Giro 360 izquierda"></button>
        <button class="leaf leaf-right" data-status="10" aria-label="Giro 360 derecha"></button>
      </div>
    </section>
  </main>

  <!-- Modal: Cargar secuencias -->
  <div class="modal fade" id="modalCargar" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content modal-soft">
        <div class="modal-header">
          <h5 class="modal-title">Seleccione</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Salir"></button>
        </div>
        <div class="modal-body">
          <div class="list-group" id="listaSecuencias"></div>
        </div>
        <div class="modal-footer">
          <button id="btnReproducir" class="btn btn-primary" disabled>Reproducir</button>
          <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Salir</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Reproducci√≥n con animaci√≥n (SIN bot√≥n de obst√°culo) -->
  <div class="modal fade" id="modalPlayer" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content modal-soft">
        <div class="modal-body">
          <div class="player-box">
            <div class="car-anim" id="carAnim"></div>
          </div>
          <div class="d-flex gap-3 justify-content-center mt-3">
            <button id="btnExitRun" class="btn btn-outline-secondary" data-bs-dismiss="modal">Salir</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast: Obst√°culo detectado -->
  <div class="position-fixed top-0 end-0 p-3" style="z-index:1080">
    <div id="toastObstacle" class="toast align-items-center text-bg-warning border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body"><strong>Obst√°culo detectado</strong>: evadiendo‚Ä¶</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script>
  window.CONFIG = {
    API: "https://34.196.181.221:5500/api",
    WS:  "wss://34.196.181.221:5500/ws"
  };
</script>

  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/main.js"></script>
</body>
</html>

